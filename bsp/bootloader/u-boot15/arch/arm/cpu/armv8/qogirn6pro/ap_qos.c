#include <common.h>
#include <asm/io.h>
#include <asm/arch/common.h>
#include "asm/arch-qogirn6pro/common.h"
#include "asm/arch-qogirn6pro/sprd_reg.h"

typedef struct _QOS_REG_STRUCT {
	const char *reg_name;
	u32 base_addr;
	u32 mask_value;
	u32 set_value;
} QOS_REG_T;

static QOS_REG_T nic400_ap_main_mtx_mx_qos_list[] = {
	//nic400_ap_main_mtx_m1_qos_list
	{"REGU_OT_CTRL_EN",	0x20150080,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150084,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150088,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015008C,	0x3f3fffff,	0x00000000},
	{"REGU_LAT_EN",		0x20150090,	0x00000003,	0x00000000},
	{"REGU_LAT_W_CFG",	0x20150094,	0xffffffff,	0x00000000},
	{"REGU_LAT_R_CFG",	0x20150098,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x201500C0,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x201500C4,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x201500C8,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x201500CC,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x201500D0,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x201500E0,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x201500E4,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x201500E8,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m2_qos_list
	{"REGU_OT_CTRL_EN",	0x20150100,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150104,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150108,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015010C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x20150140,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x20150144,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x20150148,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x2015014C,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x20150150,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x20150160,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x20150164,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x20150168,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m3_qos_list
	{"REGU_OT_CTRL_EN",	0x20150180,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150184,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150188,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015018C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x201501C0,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x201501C4,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x201501C8,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x201501CC,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x201501D0,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x201501E0,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x201501E4,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x201501E8,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m4_qos_list
	{"REGU_OT_CTRL_EN",	0x20150200,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150204,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150208,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015020C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x20150240,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x20150244,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x20150248,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x2015024C,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x20150250,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x20150260,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x20150264,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x20150268,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m5_qos_list
	{"REGU_OT_CTRL_EN",	0x20150280,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150284,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150288,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015028C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x201502C0,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x201502C4,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x201502C8,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x201502CC,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x201502D0,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x201502E0,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x201502E4,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x201502E8,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m6_qos_list
	{"REGU_OT_CTRL_EN",	0x20150300,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150304,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150308,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015030C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x20150340,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x20150344,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x20150348,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x2015034C,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x20150350,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x20150360,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x20150364,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x20150368,	0x00000701,	0x00000001},
	//nic400_ap_main_mtx_m7_qos_list
	{"REGU_OT_CTRL_EN",	0x20150380,	0x00000001,	0x00000000},
	{"REGU_OT_CTRL_AW_CFG",	0x20150384,	0xffffffff,	0x00000000},
	{"REGU_OT_CTRL_AR_CFG",	0x20150388,	0x3f3f3f3f,	0x00000000},
	{"REGU_OT_CTRL_AX_CFG",	0x2015038C,	0x3f3fffff,	0x00000000},
	{"REGU_BW_NRT_EN",	0x201503C0,	0x00000003,	0x00000000},
	{"REGU_BW_NRT_W_CFG_0",	0x201503C4,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_W_CFG_1",	0x201503C8,	0x073fffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_0",	0x201503CC,	0xffffffff,	0x00000000},
	{"REGU_BW_NRT_R_CFG_1",	0x201503D0,	0x073fffff,	0x00000000},
	{"REGU_AXQOS_GEN_EN",	0x201503E0,	0x80000003,	0x00000003},
	{"REGU_AXQOS_GEN_CFG",	0x201503E4,	0x3fff3fff,	0x05550555},
	{"REGU_URG_CNT_CFG",	0x201503E8,	0x00000701,	0x00000001},
};

static QOS_REG_T ap_ahb_rf_qos_list[] = {
	{"M0_LPC",		0x20000060,	0x00010000,	0x00000000},
	{"M0_LPC",		0x20000060,	0x00010000,	0x00010000},
	{"M1_LPC",		0x20000064,	0x00010000,	0x00000000},
	{"M1_LPC",		0x20000064,	0x00010000,	0x00010000},
	{"M2_LPC",		0x20000068,	0x00010000,	0x00000000},
	{"M2_LPC",		0x20000068,	0x00010000,	0x00010000},
	{"M3_LPC",		0x2000006C,	0x00010000,	0x00000000},
	{"M3_LPC",		0x2000006C,	0x00010000,	0x00010000},
	{"M4_LPC",		0x20000070,	0x00010000,	0x00000000},
	{"M4_LPC",		0x20000070,	0x00010000,	0x00010000},
	{"M5_LPC",		0x20000074,	0x00010000,	0x00000000},
	{"M5_LPC",		0x20000074,	0x00010000,	0x00010000},
	{"M6_LPC",		0x20000078,	0x00010000,	0x00000000},
	{"M6_LPC",		0x20000078,	0x00010000,	0x00010000},
	{"M7_LPC",		0x2000007C,	0x00010000,	0x00000000},
	{"M7_LPC",		0x2000007C,	0x00010000,	0x00010000},
};

void ap_qos_cfg(void)
{
	u32 i, value;
	//enable nic400_eb
	CHIP_REG_OR(REG_AP_APB_APB_EB1, BIT_AP_APB_NIC400_EB);

	for(i = 0; i < ARRAY_SIZE(nic400_ap_main_mtx_mx_qos_list); i++) {
		value = nic400_ap_main_mtx_mx_qos_list[i].set_value &
			nic400_ap_main_mtx_mx_qos_list[i].mask_value;
                CHIP_REG_SET(nic400_ap_main_mtx_mx_qos_list[i].base_addr, value);
	}

	for(i = 0; i < ARRAY_SIZE(ap_ahb_rf_qos_list); i++) {
		value = ap_ahb_rf_qos_list[i].set_value &
			ap_ahb_rf_qos_list[i].mask_value;
                CHIP_REG_SET(ap_ahb_rf_qos_list[i].base_addr, value);
	}

	CHIP_REG_AND(REG_AP_APB_APB_EB1, ~BIT_AP_APB_NIC400_EB);
}
